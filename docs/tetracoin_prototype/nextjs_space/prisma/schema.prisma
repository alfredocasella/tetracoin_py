
generator client {
    provider = "prisma-client-js"
    binaryTargets = ["native", "linux-musl-arm64-openssl-3.0.x"]
    output = "/home/ubuntu/tetracoin_prototype/nextjs_space/node_modules/.prisma/client"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model Level {
  id                    String   @id @default(cuid())
  levelNumber           Int      @unique
  worldNumber           Int
  name                  String
  gridWidth             Int      @default(6)
  gridHeight            Int      @default(6)
  timeLimit             Int      @default(180)
  maxMovesForThreeStars Int
  maxMovesForTwoStars   Int
  blocks                Json     // Array of {shape, color, x, y, counter}
  coins                 Json     // Array of {color, x, y}
  walls                 Json     // Array of {x, y}
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
  
  UserProgress UserProgress[]
  
  @@index([worldNumber, levelNumber])
}

model UserProgress {
  id          String   @id @default(cuid())
  userId      String   @default("guest")
  levelId     String
  level       Level    @relation(fields: [levelId], references: [id])
  stars       Int      @default(0)
  bestMoves   Int?
  bestTime    Int?
  completed   Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@unique([userId, levelId])
  @@index([userId])
}
